# Мы купили Arduino Pro Mini, что делать дальше?

*[https://www.drive2.ru/b/2642464/]*

Когда меня спрашивают: "Хочу научится программировать микроконтроллеры, с чего начать, что купить?", то с моей точки зрения ответ однозначен: "Покупаем Arduino Pro Mini и пробуем, если все получается — переходим к более сложным вещам".

**Что такое Ардуино**

Несмотря на название раздела не буду рассказывать, что такое Ардуино и откуда оно взялось, так как привел в свое время неплохую статью об этом — [www.drive2.ru/b/2520138/](https://www.drive2.ru/b/2520138/) . Просто вспомним, что под понятием Ардуино обычно понимают совокупность трех вещей: платы или платформы Arduino (в данном случае Arduino Pro Mini), среды разработки Arduino IDE и языка программирования C++ с набором специальных библиотек. Любую из этих трех вещей мы можем подменить на аналог, но об этом мы поговорим позже. А пока просто скачаем Arduino IDE с официального сайта — [www.arduino.cc/en/Main/Software](https://www.arduino.cc/en/Main/Software) и установим его на компьютер.

**Что же мы купили?**

Если мы все купили правильно, то перед собой мы увидим две платки

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image002.jpg)

Верхняя плата — это собственно и есть Arduino Pro Mini, нижняя — USB-UART / USB-TTL конвертер. Последний может выглядеть не так, как на фото, а иметь вид готового кабеля.

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image004.jpg)

(Лично я советовал бы выбрать первый вариант, но это как говорится на вкус и цвет …)

Теперь о плате/платформе Arduino Pro Mini: Конструктивно она представляет собой плату с распаянным на ней микроконтролером, кнопкой RESET, микросхемой питания и прочей, не существенной для нас на данном этапе, периферией.


 Существует две версии Pro Mini: одна работает от 3.3В при частоте 8 МГц, другая — от 5В при 16 МГц. В основе платы лежит микроконтроллер Atmega 168 или Atmega 328 — отличие между ними заключается в объеме внутрисистемно программируемой Flash памяти — 16 или 32 кБайта. Это так называемая "память программ", т.е. память в которую будет записана программа и содержимое ее не будет изменятся в процессе работы. Напомню, что Atmega построен по так называемой Гарвардской архитектуре ([www.drive2.ru/b/2506495/](https://www.drive2.ru/b/2506495/)) в которой "память программ" и "память данных" реализованы отдельно, для большего быстродействия и надежности. 

"Память данных" делится на 2 части: оперативную SRAM, которая что у 168, что у 328 составляет 1 Кб, и постоянную EEPROM (Electrically Erasable Programmable Read-Only Memory) объемом 512 байт, данные из которой не "теряются" при отключении питания.


 В зависимости от исполнения на плате может быть 30, 32 или 34 вывода (PIN). На картинке ниже показана"максимальный" 34 пиновый вариант

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image006.jpg)

 

Посмотрели? Страшно? Давайте разберемся что где.

*GND* — это у нас выводы куда подключается "земляные" провода, т.е. приходит/выводится "-" питания

*VCC* — плюсовые выводы для питания платы напряжением 5В (иногда 3,3В). Также этот вывод моно использовать для подачу "наружу" опорного напряжение для цифровых входов.

*RAW* — вывод используется, если у нас нет стабилизированного напряжения 5В, но есть постоянное в диапазоне от 7 до 12В. Иногда указывают максимальное значение 30В — т.е. то напряжение которое микросхема питания может выдержать непродолжительное время не перегреваясь.

*Помним, что в автомобиле диапазон напряжений от 12 до 15,5В, поэтому подключать RAW к "+" авто напрямую нельзя и нужно собрать схему по питанию следующего вида:*

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image007.jpg)

 

В принципе, заменив микросхему 7812 на 7805, можно питать Pro Mini и через вывод *VCC*

*TXD* и *RXD* — выводы UART/USART — [www.drive2.ru/b/2602560/](https://www.drive2.ru/b/2602560/)


 *RST* — он же RESET — в мануале написано насчет него написано следующее "низкий уровень сигнала на выводе перезагружает микроконтроллер. Обычно применяется для подключения кнопки перезагрузки на плате расширения, закрывающей доступ к кнопке на самой плате Arduino". На деле это означает что когда этот вывод подключается к земле, происходит перезапуск (сброс) Arduino Pro Mini.

Выводы обозначенные на плате цифрами с 2 до 13 — цифровые выводы (Обязательно читаем — [www.drive2.ru/b/2528993/](https://www.drive2.ru/b/2528993/)), могут настраиваться как вход или выход. Выводы работают при напряжении 3,3 В. Каждый вывод имеет нагрузочный резистор (стандартно отключен) 20-50 кОм и может пропускать до 40 мА. Они могут выводить значения только высокого (3,3В или 5В в зависимости от версии) или низкого (0В) уровня. Некоторое из них обозначенные на схеме выше как *PWM* могут выводить ШИМ сигнал ([www.drive2.ru/b/2558797/](https://www.drive2.ru/b/2558797/)) с разрешением 8 бит (от 0 до 255)


 Выводы *А0-А7* — аналоговые входы с 10 битным АЦП ([www.drive2.ru/b/2558839/](https://www.drive2.ru/b/2558839/)). В зависимости от исполнения платы их может быть от 4 до 8. Эти выводы могут также работать как цифровые.


 *DTR* (Data Terminal Ready) — Готовность приемника данных.

Некоторые из описанных выводов могут выполнять намного больше функций, что видно из схемы, но об этом мы поговорим позже, по мере того как будем использовать эти функции.

**Подключаемся**

Схема подключения достаточно простая и ошибиться достаточно сложно

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image009.jpg)

Единственное что посоветую использовать не идущие в комплекте провода, а купить разъем питания на 6 контактов с шагом контактов 2,54мм. Он называется NS25 — 2,54 мм и такой же на 5 контактов для подключения к USB-UART / USB-TTL конвертеру.

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image010.jpg)

После подключения у меня получилось так

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image011.jpg)

 

Можно выпаять гребенку на конвертере и припаяться проводами непосредственно к плате — это позволит отказаться от одного из разьемных соединений и защитить конвертер, одев на него термоусадку.

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image012.jpg)

Как видно используется только по 4 провода — это связано с тем, что у меня на обоих конвертерах нет вывода DTR

**Что такое DTR и что делать если его нет?**

Данный вывод предназначен для того, чтобы USB-serial контроллер Arduino перезагружал МК каждый раз, когда терминальная программа (в т.ч. Serial monitor, встроенный в ПО Arduino IDE) устанавливает соединение. Реализовано это следующим образом: у USB-serial контроллера вывод DTR (Data Terminal Ready) связан с выводом RESET. Если программа, работающая с виртуальным последовательным портом, использует DTR, то при установке соединения МК перезагружается.

Само по себе это обеспечивает беспроблемную загрузку скетча из Arduino IDE — МК перезагружается перед загрузкой кода. В этом смысле автоматическая перезагрузка облегчает жизнь. Кроме того, перезагрузка при подключении терминала тоже может оказаться удобной, т.к. довольно много скетчей выводят какую-то полезную информацию через последовательный порт, при этом скетч выполняется сразу после загрузки в МК, когда терминал еще не подключен (т.к. недавно порт был занят), так что увидеть вывод скетча в первые секунды его работы было бы нельзя. Перезагрузка в момент подключения терминала позволяет получить весь вывод, начиная с момента загрузки МК.

В случае, если этот вывод отсутствует, то у нас есть 3 варианта


\1) Купить другой конвертер :)

\2) Распаять вывод самому. (Как это сделать написано здесь — [new-tech.in.ua/tips/109-usb-uart-converter](http://new-tech.in.ua/tips/109-usb-uart-converter))

\3) Отправлять на перезагрузку вручную при помощи кнопки RESET расположенной на плате — об этом ниже.

**Подключаем плату к компьютеру**

Я не буду рассказывать как устанавливать драйвера конвертера и Arduino IDE — все достаточно стандартно.

Если все сделали правильно, то при подключении конвертера в системе появится виртуальный СОМ — порт. Это легко увидеть:

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image014.jpg)

На правой картинке появляется дополнительный порт СОМ10 (у вас номер может быть другим) — его нужно выбрать, клацнув по нему мышкой.
 Далее проверяем правильность указания платы, программатора — все должно быть как на картинке выше.


 Указываем микроконтроллер 168 или 328, 5В или 3,3В

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image016.jpg)

**Почувствуем себя программистами**

Попробуем залить простейшую программу. Для этого воспользуемся библиотекой примеров и тем, что у нас на самой плате на 13 выводе припаян светодиод. Скорее всего программа мигания этим светодиодом будет загружена в качестве тестовой, но мы все равно загрузим свою :). Находится этот пример тут:

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image018.jpg)

Листинг программы:

**// Процедура инициализации
 void setup()** 

**{
  // инициализируем вывод 13 на вывод.
  pinMode(13, OUTPUT);
 }**

**// Основное тело программы
 void loop()** 

**{**

 **// включаем светодиод (Подаем сигнал высокого уровня на вывод 13)
  digitalWrite(13, HIGH);**

 **// ждем 500 милисекунд** 

 **// (в стандартном примере 1000, что означает одну секунду)** 

 **delay(500);**

 **// выключаем светодиод (Подаем сигнал низкого уровня на вывод 13)
  digitalWrite(13, LOW);**

 **// ждем 500 милисекунд после чего идем опять в начало основной программы
  delay(500);** 

**}
** 
 Данная программа будет выполняться по кругу пока включен микроконтроллер.

**"Заливаем" программу**

Тут все просто — нажимаем на кнопочку "вгрузить"

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image020.jpg)

 

*Если вывод DTR не подключен, то нажимаем на плате кнопку RESET и не отпускаем пока внизу окна Arduino IDE не появится надпись "вгружаем" — этот момент важно не пропустить, иначе микроконтроллер не будет своевременно перезагружен и заливка программы не состоится. Если DTR подключен, то просто ждем*

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image022.jpg)

Если все мы сделали правильно, то вскоре мы увидим надпись "вгрузили" и светодиод начнет мигать с периодом 0,5с.

![img](file:///C:\Users\615A~1\AppData\Local\Temp\msohtml1\01\clip_image024.jpg)

**Послесловие**

Я не рассказывал как припаивать "гребенку" к плате — если вы не умеете это делать, то сначала научитесь паять.


 Как подключать всевозможную периферию можно подглядеть здесь — [www.drive2.ru/c/1735998/](https://www.drive2.ru/c/1735998/)


 И вообще очень рекомендую к прочтению книгу Улли Соммер "Программирование микроконтроллерных плат Arduino/Freeduino" (она есть в интернете и ее несложно найти).

 
