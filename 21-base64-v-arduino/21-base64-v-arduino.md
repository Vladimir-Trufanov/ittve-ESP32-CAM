## [Base64 в Ардуино](#)


#### [Adam Rudd Cologne, Germany: arduino-base64](https://github.com/adamvr/arduino-base64/tree/master)

Нужно понять, что такое base64:

Принцип кодирования в ***base64*** заключается в представлении байт с помощью 64 чётко определённых символов (плюс 65й, знак «=»).

64 различных символа могут представлять 6 бит, но не 8.

Итак, вы берёте 3 байта (3 x 8 бит = 24 бита) и представляете их в виде 4 символов BASE64, так как 4 x 6 бит = 24 бита.

В конце двоичной последовательности у вас может остаться меньше 3 байт, поэтому используется специальный процесс:

-> если у вас осталось только 2 байта, это 16 бит. Правило заключается в том, что вы добавляете достаточно нулевых битов «справа», чтобы их количество было кратно 6, поэтому здесь вы добавляете два нуля, чтобы в сумме получилось 18 бит, которые вы кодируете тремя символами и добавляете знак «=&» после, чтобы распознать недостающую информацию

-> если у вас остался только 1 байт, то есть 8 бит. Ближайшее кратное 6 число — 12, поэтому вы добавляете 4 нуля справа, кодируете эти 12 бит в 2 символа BASE64 и добавляете два знака «=», чтобы распознать отсутствующую информацию

Итак, чтобы использовать библиотеку, описанную выше, вам нужно считывать файл изображения порциями по 3 байта, сохранять их в небольшом буфере и передавать в функцию кодирования. Вы получите 4 символа, представляющих эти 3 байта, затем перейдете к следующим 3 байтам и так до конца файла. В конце файла у вас останется 1, 2 или 3 байта. поэтому убедитесь, что вы передаёте правильный размер буфера в функцию кодирования, чтобы она выдавала правильный результат со знаком «=», если это необходимо

У вашего Arduino ограниченный объём памяти, поэтому вы можете отправлять с ESP поток байтов, необходимый для представления вашего изображения, даже если оно занимает несколько мегабайт.

имеет смысл?

Обратите внимание, что вместо того, чтобы считывать файл по 3 байта за раз, вы можете сделать это с помощью буфера, кратного 3 байтам. Это будет немного эффективнее, но убедитесь, что вы обрабатываете конец файла с помощью буфера нужного размера, чтобы знаки «&» добавлялись в выходной поток только один раз.

#### [Densaugeo: base64_arduino](https://github.com/Densaugeo/base64_arduino)



